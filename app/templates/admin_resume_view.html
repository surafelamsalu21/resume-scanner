<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Resume Details - Admin Dashboard</title>
		<link
			rel="stylesheet"
			href="{{ url_for('static', filename='css/style.css') }}"
		/>
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
		/>
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css"
		/>
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
			rel="stylesheet"
		/>
		<style>
			:root {
				--primary-color: #4a6cf7;
				--secondary-color: #6c757d;
				--success-color: #28a745;
				--danger-color: #dc3545;
				--warning-color: #ffc107;
				--info-color: #17a2b8;
				--light-color: #f8f9fa;
				--dark-color: #343a40;
				--border-color: #dee2e6;
				--border-radius: 8px;
				--box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
				--text-muted: #6c757d;
				--light-bg: #f5f7fa;
				--transition: all 0.3s ease;
			}

			body {
				font-family: 'Inter', sans-serif;
				margin: 0;
				padding: 0;
				background-color: var(--light-bg);
				color: #333;
				line-height: 1.6;
			}

			/* Header Styles */
			header {
				background-color: white;
				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
				padding: 15px 0;
				position: sticky;
				top: 0;
				z-index: 100;
			}

			.container {
				max-width: 1200px;
				margin: 0 auto;
				padding: 0 15px;
			}

			.navbar {
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.logo {
				font-size: 24px;
				font-weight: 700;
				color: var(--primary-color);
				text-decoration: none;
				display: flex;
				align-items: center;
			}

			.logo i {
				margin-right: 10px;
			}

			.nav-links {
				display: flex;
				gap: 20px;
			}

			.nav-links a {
				color: var(--dark-color);
				text-decoration: none;
				font-weight: 500;
				transition: color 0.3s;
			}

			.nav-links a:hover {
				color: var(--primary-color);
			}

			.nav-links a.active {
				color: var(--primary-color);
				font-weight: 600;
			}

			.dashboard-container {
				display: flex;
				min-height: calc(100vh - 160px);
			}

			.sidebar {
				width: 250px;
				background-color: var(--dark-color);
				color: white;
				padding: 20px 0;
				position: sticky;
				top: 0;
				height: 100vh;
			}

			.sidebar-header {
				padding: 0 20px 20px;
				border-bottom: 1px solid rgba(255, 255, 255, 0.1);
				margin-bottom: 20px;
			}

			.sidebar-menu {
				list-style: none;
				padding: 0;
				margin: 0;
			}

			.sidebar-menu li {
				margin-bottom: 5px;
			}

			.sidebar-menu a {
				display: block;
				padding: 12px 20px;
				color: rgba(255, 255, 255, 0.8);
				text-decoration: none;
				transition: all 0.3s;
			}

			.sidebar-menu a:hover,
			.sidebar-menu a.active {
				background-color: rgba(255, 255, 255, 0.1);
				color: white;
			}

			.sidebar-menu i {
				margin-right: 10px;
				width: 20px;
				text-align: center;
			}

			.main-content {
				flex: 1;
				padding: 30px;
				background-color: var(--light-bg);
			}

			.dashboard-header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 30px;
			}

			.dashboard-title {
				font-size: 24px;
				font-weight: 600;
				color: var(--dark-color);
			}

			.user-info {
				display: flex;
				align-items: center;
			}

			.user-name {
				margin-right: 15px;
				font-weight: 500;
			}

			.resume-container {
				display: grid;
				grid-template-columns: 1fr 1fr;
				gap: 30px;
			}

			.resume-section {
				background-color: white;
				border-radius: 12px;
				padding: 25px;
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
				margin-bottom: 30px;
				transition: transform 0.3s ease, box-shadow 0.3s ease;
				overflow: hidden;
			}

			.resume-section:hover {
				transform: translateY(-5px);
				box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
			}

			.resume-section h3 {
				margin-top: 0;
				margin-bottom: 20px;
				padding-bottom: 15px;
				border-bottom: 2px solid #f0f0f0;
				color: var(--primary-color);
				font-size: 20px;
				font-weight: 600;
			}

			.resume-info {
				margin-bottom: 20px;
			}

			.resume-info-item {
				display: flex;
				margin-bottom: 15px;
				align-items: flex-start;
			}

			.resume-info-label {
				font-weight: 600;
				width: 150px;
				color: var(--dark-color);
				padding-right: 15px;
			}

			.resume-info-value {
				flex: 1;
				line-height: 1.5;
			}

			.badge {
				display: inline-block;
				padding: 6px 12px;
				border-radius: 20px;
				font-size: 12px;
				font-weight: 500;
				text-transform: uppercase;
				letter-spacing: 0.5px;
			}

			.badge-primary {
				background-color: var(--primary-color);
				color: white;
			}

			.badge-success {
				background-color: var(--success-color);
				color: white;
			}

			.badge-warning {
				background-color: var(--warning-color);
				color: white;
			}

			.badge-danger {
				background-color: var(--danger-color);
				color: white;
			}

			.badge-info {
				background-color: var(--info-color);
				color: white;
			}

			.badge-secondary {
				background-color: var(--secondary-color);
				color: white;
			}

			.action-buttons {
				display: flex;
				gap: 10px;
				margin-top: 20px;
				margin-bottom: 30px;
				flex-wrap: wrap;
			}

			.btn {
				display: inline-flex;
				align-items: center;
				justify-content: center;
				font-weight: 500;
				text-align: center;
				white-space: nowrap;
				vertical-align: middle;
				user-select: none;
				border: 1px solid transparent;
				padding: 0.5rem 1rem;
				font-size: 0.95rem;
				line-height: 1.5;
				border-radius: 30px;
				transition: all 0.2s ease-in-out;
				cursor: pointer;
				box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
			}

			.btn i {
				margin-right: 8px;
			}

			.btn:hover {
				transform: translateY(-2px);
				box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
			}

			.btn-primary {
				color: #fff;
				background-color: var(--primary-color);
				border-color: var(--primary-color);
			}

			.btn-primary:hover {
				background-color: #3a5bd9;
				border-color: #3a5bd9;
			}

			.btn-success {
				color: #fff;
				background-color: var(--success-color);
				border-color: var(--success-color);
			}

			.btn-success:hover {
				background-color: #218838;
				border-color: #1e7e34;
			}

			.btn-danger {
				color: #fff;
				background-color: var(--danger-color);
				border-color: var(--danger-color);
			}

			.btn-danger:hover {
				background-color: #c82333;
				border-color: #bd2130;
			}

			.btn-info {
				color: #fff;
				background-color: var(--info-color);
				border-color: var(--info-color);
			}

			.btn-info:hover {
				background-color: #138496;
				border-color: #117a8b;
			}

			.btn-secondary {
				color: #fff;
				background-color: var(--secondary-color);
				border-color: var(--secondary-color);
			}

			.btn-secondary:hover {
				background-color: #5a6268;
				border-color: #545b62;
			}

			.skills-list {
				display: flex;
				flex-wrap: wrap;
				gap: 10px;
				margin-top: 10px;
			}

			.skill-item {
				background-color: #f5f5f5;
				padding: 8px 15px;
				border-radius: 20px;
				font-size: 14px;
				display: flex;
				align-items: center;
				transition: all 0.3s ease;
			}

			.skill-item:hover {
				background-color: #e9ecef;
				transform: translateY(-2px);
			}

			.skill-match {
				display: inline-flex;
				align-items: center;
				justify-content: center;
				width: 35px;
				height: 35px;
				line-height: 35px;
				text-align: center;
				border-radius: 50%;
				background-color: var(--primary-color);
				color: white;
				font-weight: 600;
				margin-left: 10px;
				font-size: 12px;
			}

			.feedback-section {
				margin-top: 20px;
			}

			.feedback-form {
				margin-top: 15px;
			}

			.feedback-form textarea {
				width: 100%;
				min-height: 120px;
				padding: 15px;
				border: 1px solid #ddd;
				border-radius: 8px;
				resize: vertical;
				font-family: 'Inter', sans-serif;
				transition: border-color 0.3s ease;
			}

			.feedback-form textarea:focus {
				outline: none;
				border-color: var(--primary-color);
				box-shadow: 0 0 0 3px rgba(74, 108, 247, 0.1);
			}

			.feedback-form button {
				margin-top: 10px;
				width: 100%;
				padding: 12px;
			}

			.main-header {
				background-color: white;
				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
				padding: 15px 0;
				position: sticky;
				top: 0;
				z-index: 100;
			}

			.header-content {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 0 30px;
				max-width: 1200px;
				margin: 0 auto;
			}

			.logo {
				display: flex;
				align-items: center;
			}

			.logo h1 {
				margin: 0;
				font-size: 24px;
				color: var(--primary-color);
			}

			.logo a {
				text-decoration: none;
				color: inherit;
				display: flex;
				align-items: center;
			}

			.logo a i {
				margin-right: 10px;
				font-size: 24px;
			}

			.main-nav ul {
				display: flex;
				list-style: none;
				margin: 0;
				padding: 0;
			}

			.main-nav li {
				margin-left: 20px;
			}

			.main-nav a {
				text-decoration: none;
				color: var(--dark-color);
				font-weight: 500;
				transition: color 0.3s;
				padding: 8px 0;
				position: relative;
			}

			.main-nav a:after {
				content: '';
				position: absolute;
				width: 0;
				height: 2px;
				bottom: 0;
				left: 0;
				background-color: var(--primary-color);
				transition: width 0.3s;
			}

			.main-nav a:hover {
				color: var(--primary-color);
			}

			.main-nav a:hover:after {
				width: 100%;
			}

			.main-footer {
				background-color: white;
				padding: 20px 0;
				text-align: center;
				color: var(--text-muted);
				font-size: 14px;
				margin-top: 30px;
				border-top: 1px solid #eee;
			}

			/* Resume content styling */
			.resume-content {
				font-family: 'Inter', sans-serif;
				background-color: white;
				padding: 0;
				border-radius: 0;
				max-height: 100%;
				overflow-y: auto;
			}

			.resume-section-title {
				font-size: 18px;
				font-weight: 600;
				color: var(--primary-color);
				margin-bottom: 15px;
				padding-bottom: 10px;
				border-bottom: 1px solid #eee;
			}

			.resume-content-section {
				margin-bottom: 25px;
				padding-bottom: 15px;
			}

			.resume-content-section:last-child {
				margin-bottom: 0;
				padding-bottom: 0;
			}

			.resume-content ul {
				padding-left: 20px;
				margin: 10px 0;
			}

			.resume-content li {
				margin-bottom: 8px;
			}

			.education-item, .experience-item, .project-item {
				margin-bottom: 20px;
				padding-bottom: 15px;
				border-bottom: 1px dashed #eee;
			}

			.education-item:last-child, .experience-item:last-child, .project-item:last-child {
				border-bottom: none;
				margin-bottom: 0;
				padding-bottom: 0;
			}

			.item-header {
				display: flex;
				justify-content: space-between;
				margin-bottom: 5px;
				flex-wrap: wrap;
			}

			.item-title {
				font-weight: 600;
				color: var(--dark-color);
				margin-right: 10px;
			}

			.item-date {
				color: var(--text-muted);
				font-size: 14px;
			}

			.item-subtitle {
				color: var(--secondary-color);
				margin-bottom: 8px;
				font-size: 15px;
			}

			.item-description {
				font-size: 14px;
				line-height: 1.6;
				color: #444;
			}

			.skills-grid {
				display: flex;
				flex-wrap: wrap;
				gap: 10px;
				margin: 10px 0;
			}

			.skill-tag {
				background-color: #f0f4ff;
				color: var(--primary-color);
				padding: 8px 15px;
				border-radius: 20px;
				font-size: 14px;
				display: inline-block;
				transition: all 0.2s ease;
				margin-bottom: 8px;
				box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
			}

			.skill-tag:hover {
				background-color: #e0e7ff;
				transform: translateY(-2px);
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
			}

			.skill-level {
				display: inline-block;
				margin-left: 8px;
				font-size: 12px;
				font-weight: 600;
				color: var(--primary-color);
				opacity: 0.8;
			}

			.contact-info {
				display: flex;
				flex-wrap: wrap;
				gap: 15px;
				margin-bottom: 15px;
			}

			.contact-item {
				display: flex;
				align-items: center;
				font-size: 14px;
				color: #555;
			}

			.contact-item i {
				margin-right: 8px;
				color: var(--primary-color);
				width: 16px;
				text-align: center;
			}

			.summary-section {
				background-color: #f9f9ff;
				padding: 15px;
				border-radius: 8px;
				margin-bottom: 20px;
				font-style: italic;
				line-height: 1.6;
				color: #444;
				border-left: 3px solid var(--primary-color);
			}

			.pdf-viewer {
				width: 100%;
				height: 600px;
				border: 1px solid #eee;
				border-radius: 8px;
			}

			/* Progress bars for skills */
			.progress-container {
				margin-top: 5px;
				margin-bottom: 15px;
			}

			.progress-bar-container {
				width: 100%;
				height: 8px;
				background-color: #e9ecef;
				border-radius: 4px;
				overflow: hidden;
				margin-top: 5px;
			}

			.progress-bar {
				height: 100%;
				background-color: var(--primary-color);
				border-radius: 4px;
			}

			.progress-label {
				display: flex;
				justify-content: space-between;
				font-size: 14px;
				margin-bottom: 5px;
			}

			.progress-name {
				font-weight: 500;
				color: #444;
			}

			.progress-value {
				color: var(--primary-color);
				font-weight: 600;
			}

			.score-circle {
				width: 120px;
				height: 120px;
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				margin: 0 auto 20px;
				position: relative;
			}

			.score-circle::before {
				content: '';
				position: absolute;
				width: 100px;
				height: 100px;
				border-radius: 50%;
				background-color: white;
			}

			.score-value {
				position: relative;
				font-size: 32px;
				font-weight: 700;
				color: var(--primary-color);
			}

			.analysis-header {
				text-align: center;
				margin-bottom: 30px;
			}

			.analysis-title {
				font-size: 22px;
				font-weight: 600;
				color: var(--dark-color);
				margin-bottom: 5px;
			}

			.analysis-subtitle {
				color: var(--text-muted);
				font-size: 14px;
			}

			/* Custom bullet points for recommendations */
			.recommendations-list, .strengths-list, .weaknesses-list {
				list-style: none;
				padding-left: 0;
				margin: 10px 0;
			}

			.recommendations-list li, .strengths-list li, .weaknesses-list li {
				position: relative;
				padding-left: 28px;
				margin-bottom: 12px;
				line-height: 1.6;
			}

			.recommendations-list li:before, .strengths-list li:before {
				content: '';
				position: absolute;
				left: 0;
				top: 6px;
				width: 16px;
				height: 16px;
				background-color: var(--primary-color);
				mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath d='M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z'/%3E%3C/svg%3E");
				-webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath d='M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7 425.4 105.4c12.5-12.5 32.8-12.5 45.3 0z'/%3E%3C/svg%3E");
				mask-size: cover;
				-webkit-mask-size: cover;
			}

			.weaknesses-list li:before {
				content: '';
				position: absolute;
				left: 0;
				top: 6px;
				width: 16px;
				height: 16px;
				background-color: var(--danger-color);
				mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath d='M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z'/%3E%3C/svg%3E");
				-webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath d='M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z'/%3E%3C/svg%3E");
				mask-size: cover;
				-webkit-mask-size: cover;
			}

			@media (max-width: 992px) {
				.resume-container {
					grid-template-columns: 1fr;
				}
			}

			@media (max-width: 768px) {
				.dashboard-container {
					flex-direction: column;
				}

				.sidebar {
					width: 100%;
					height: auto;
					position: relative;
				}

				.action-buttons {
					flex-direction: column;
				}

				.action-buttons .btn {
					width: 100%;
				}

				.header-content {
					flex-direction: column;
					padding: 15px;
				}

				.main-nav {
					margin-top: 15px;
				}

				.main-nav ul {
					flex-wrap: wrap;
					justify-content: center;
				}

				.main-nav li {
					margin: 5px 10px;
				}

				.item-header {
					flex-direction: column;
				}

				.item-date {
					margin-top: 5px;
				}
			}
		</style>
	</head>
	<body>
		<header>
			<div class="container">
				<nav class="navbar">
					<a href="/" class="logo">
						<i class="fas fa-file-alt"></i>
						Resume AI
					</a>
					<div class="nav-links">
						<a href="{{ url_for('admin.dashboard') }}">Dashboard</a>
						<a href="{{ url_for('admin.resume_dashboard') }}" class="active">Resumes</a>
						<a href="{{ url_for('admin.job_categories_page') }}">Job Categories</a>
						<a href="{{ url_for('admin.prompts_management_page') }}">AI Prompts</a>
						<a href="#" id="logout-link">Logout</a>
					</div>
				</nav>
			</div>
		</header>

		<div class="dashboard-container">
			<aside class="sidebar">
				<div class="sidebar-header">
					<h3>Admin Panel</h3>
				</div>
				<ul class="sidebar-menu">
					<li>
						<a href="{{ url_for('admin.dashboard') }}">
							<i class="fas fa-tachometer-alt"></i> Dashboard
						</a>
					</li>
					<li>
						<a href="{{ url_for('admin.resume_dashboard') }}" class="active">
							<i class="fas fa-file-alt"></i> Resumes
						</a>
					</li>
					<li>
						<a href="{{ url_for('admin.job_categories_page') }}">
							<i class="fas fa-tags"></i> Job Categories
						</a>
					</li>
					<li>
						<a href="{{ url_for('admin.prompts_management_page') }}">
							<i class="fas fa-comment-dots"></i> AI Prompts
						</a>
					</li>
					<li>
						<a href="{{ url_for('admin.manage_settings') }}">
							<i class="fas fa-cog"></i> Settings
						</a>
					</li>
				</ul>
			</aside>

			<main class="main-content">
				<div class="dashboard-header">
					<h2 class="dashboard-title">
						Resume Details: {{ resume.candidate_name or 'Unknown Candidate' }}
					</h2>
				</div>

				<div class="action-buttons">
					<a href="{{ url_for('admin.resume_dashboard') }}" class="btn btn-secondary">
						<i class="fas fa-arrow-left"></i> Back to List
					</a>
					{% if resume.pdf_report_path %}
					<a
						href="{{ url_for('static', filename=resume.pdf_report_path) }}"
						class="btn btn-primary"
						target="_blank"
					>
						<i class="fas fa-file-pdf"></i> View PDF Report
					</a>
					{% endif %}
					<a
						href="{{ url_for('static', filename=resume.file_path) }}"
						class="btn btn-info"
						target="_blank"
					>
						<i class="fas fa-download"></i> Download Original
					</a>
					<button
						class="btn btn-success approve-cv"
						data-id="{{ resume.id }}"
						{% if resume.status == 'approved' %}disabled{% endif %}
					>
						<i class="fas fa-check"></i> Approve
					</button>
					<button
						class="btn btn-danger reject-cv"
						data-id="{{ resume.id }}"
						{% if resume.status == 'rejected' %}disabled{% endif %}
					>
						<i class="fas fa-times"></i> Reject
					</button>
				</div>

				<div class="resume-container">
					<div>
						<div class="resume-section">
							<h3>Basic Information</h3>
							<div class="resume-info">
								<div class="resume-info-item">
									<div class="resume-info-label">Status</div>
									<div class="resume-info-value">
										<span
											class="badge badge-{{ 'success' if resume.status == 'approved' else 'danger' if resume.status == 'rejected' else 'warning' if resume.status == 'pending' else 'primary' }}"
										>
											{{ resume.status }}
										</span>
									</div>
								</div>
								<div class="resume-info-item">
									<div class="resume-info-label">Candidate Name</div>
									<div class="resume-info-value">
										{{ resume.candidate_name or 'Unknown' }}
									</div>
								</div>
								<div class="resume-info-item">
									<div class="resume-info-label">Email</div>
									<div class="resume-info-value">
										{{ resume.candidate_email or 'Not available' }}
									</div>
								</div>
								<div class="resume-info-item">
									<div class="resume-info-label">Job Role</div>
									<div class="resume-info-value">{{ resume.job_role }}</div>
								</div>
								<div class="resume-info-item">
									<div class="resume-info-label">Job Category</div>
									<div class="resume-info-value">
										{% if job_posting and job_posting.category %}
											{{ job_posting.category.name }}
										{% else %}
											General
										{% endif %}
									</div>
								</div>
								{% if job_posting %}
								<div class="resume-info-item">
									<div class="resume-info-label">Job Title</div>
									<div class="resume-info-value">{{ job_posting.title }}</div>
								</div>
								<div class="resume-info-item">
									<div class="resume-info-label">Department</div>
									<div class="resume-info-value">{{ job_posting.department }}</div>
								</div>
								{% endif %}
								<div class="resume-info-item">
									<div class="resume-info-label">Upload Date</div>
									<div class="resume-info-value">
										{{ resume.upload_date.strftime('%Y-%m-%d %H:%M:%S') }}
									</div>
								</div>
								<div class="resume-info-item">
									<div class="resume-info-label">File</div>
									<div class="resume-info-value">
										{{ resume.original_filename }}
									</div>
								</div>
							</div>
						</div>

						{% if resume.processed_resume %}
						<div class="resume-section">
							<h3>Analysis Results</h3>
							
							{% if resume.processed_resume and resume.processed_resume.feedback and resume.processed_resume.feedback.error %}
								<div class="alert alert-danger">
									<strong>Analysis Error:</strong> {{ resume.processed_resume.feedback.error }}
									<p>The system encountered an error while analyzing this resume. You can try reprocessing it or check the logs for more details.</p>
									<button class="btn btn-primary reprocess-btn" data-resume-id="{{ resume.id }}">
										<i class="fas fa-sync-alt"></i> Reprocess Resume
									</button>
								</div>
							{% else %}
								<div class="analysis-header">
									<div class="score-circle" style="background: conic-gradient(var(--primary-color) 0% {{ resume.processed_resume.ranking_score if resume.processed_resume.ranking_score is not none else 0 }}%, #e9ecef {{ resume.processed_resume.ranking_score if resume.processed_resume.ranking_score is not none else 0 }}% 100%);">
										<div class="score-value">{{ "%.1f"|format(resume.processed_resume.ranking_score|float) if resume.processed_resume.ranking_score is not none else "0.0" }}%</div>
									</div>
									<div class="analysis-title">Overall Match Score</div>
									<div class="analysis-subtitle">Based on job requirements and resume analysis</div>
								</div>
								
								<div class="progress-container">
									<div class="progress-label">
										<span class="progress-name">Experience Match</span>
										<span class="progress-value">{{ "%.1f"|format(resume.processed_resume.experience_match|float) if resume.processed_resume.experience_match is not none else "0.0" }}%</span>
									</div>
									<div class="progress-bar-container">
										<div class="progress-bar" style="width: {{ resume.processed_resume.experience_match if resume.processed_resume.experience_match is not none else 0 }}%"></div>
									</div>
								</div>
								
								<div class="progress-container">
									<div class="progress-label">
										<span class="progress-name">Education Match</span>
										<span class="progress-value">{{ "%.1f"|format(resume.processed_resume.education_match|float) if resume.processed_resume.education_match is not none else "0.0" }}%</span>
									</div>
									<div class="progress-bar-container">
										<div class="progress-bar" style="width: {{ resume.processed_resume.education_match if resume.processed_resume.education_match is not none else 0 }}%"></div>
									</div>
								</div>
								
								<div class="resume-info-item">
									<div class="resume-info-label">Overall Ranking</div>
									<div class="resume-info-value">
										{% if resume.processed_resume.overall_ranking %}
										#{{ resume.processed_resume.overall_ranking }}
										{% else %} Not ranked {% endif %}
									</div>
								</div>

								{% if resume.processed_resume.skills_match %}
								<h4 class="resume-section-title">Skills Match</h4>
								{% for skill in resume.processed_resume.skills_match %}
								<div class="progress-container">
									<div class="progress-label">
										<span class="progress-name">{{ skill.skill }}</span>
										<span class="progress-value">{{ "%.1f"|format(skill.match_percentage|float) if skill.match_percentage is not none else "0.0" }}%</span>
									</div>
									<div class="progress-bar-container">
										<div class="progress-bar" style="width: {{ skill.match_percentage if skill.match_percentage is not none else 0 }}%"></div>
									</div>
								</div>
								{% endfor %}
								{% endif %}

								{% if resume.processed_resume.feedback %}
								<h4 class="resume-section-title">AI Feedback</h4>
								<div class="resume-info">
									{% if resume.processed_resume.feedback.strengths %}
									<div class="resume-info-item">
										<div class="resume-info-label">Strengths</div>
										<div class="resume-info-value">
											<ul class="strengths-list">
												{% for strength in
												resume.processed_resume.feedback.strengths %}
												<li>{{ strength }}</li>
												{% endfor %}
											</ul>
										</div>
									</div>
									{% endif %} {% if resume.processed_resume.feedback.weaknesses %}
									<div class="resume-info-item">
										<div class="resume-info-label">Weaknesses</div>
										<div class="resume-info-value">
											<ul class="weaknesses-list">
												{% for weakness in
												resume.processed_resume.feedback.weaknesses %}
												<li>{{ weakness }}</li>
												{% endfor %}
											</ul>
										</div>
									</div>
									{% endif %} {% if
									resume.processed_resume.feedback.recommendations %}
									<div class="resume-info-item">
										<div class="resume-info-label">Recommendations</div>
										<div class="resume-info-value">
											<ul class="recommendations-list">
												{% for recommendation in
												resume.processed_resume.feedback.recommendations %}
												<li>{{ recommendation }}</li>
												{% endfor %}
											</ul>
										</div>
									</div>
									{% endif %} {% if resume.processed_resume.feedback.summary %}
									<div class="resume-info-item">
										<div class="resume-info-label">Summary</div>
										<div class="resume-info-value">
											{{ resume.processed_resume.feedback.summary }}
										</div>
									</div>
									{% endif %}
								</div>
								{% endif %}
							{% endif %}
						</div>
						{% endif %}

						<div class="resume-section">
							<h3>Admin Feedback</h3>
							<div class="feedback-section">
								<div class="feedback-form">
									<textarea
										id="admin-feedback"
										placeholder="Add your feedback here..."
									>{{ resume.admin_feedback or '' }}</textarea>
									<button
										class="btn btn-primary mt-2"
										id="save-feedback-btn"
										data-id="{{ resume.id }}"
									>
										Save Feedback
									</button>
								</div>
							</div>
						</div>
					</div>

					<div>
						{% if resume.pdf_report_path %}
						<div class="resume-section">
							<h3>PDF Report</h3>
							<iframe
								src="{{ url_for('static', filename=resume.pdf_report_path) }}"
								class="pdf-viewer"
							></iframe>
						</div>
						{% endif %}

						<div class="resume-section">
							<h3>Resume Content</h3>
							<div class="resume-content">
								{% if resume.processed_resume and resume.processed_resume.processed_data %}
									{% set data = resume.processed_resume.processed_data %}
									
									{% if data.candidate_name or data.contact_info %}
									<div class="resume-content-section">
										<h4 class="resume-section-title">Personal Information</h4>
										
										{% if data.candidate_name %}
										<h2 style="margin-top: 0; color: var(--dark-color);">{{ data.candidate_name }}</h2>
										{% endif %}
										
										{% if data.contact_info %}
										<div class="contact-info">
											{% if data.contact_info.email %}
											<div class="contact-item">
												<i class="fas fa-envelope"></i> {{ data.contact_info.email }}
											</div>
											{% endif %}
											
											{% if data.contact_info.phone %}
											<div class="contact-item">
												<i class="fas fa-phone"></i> {{ data.contact_info.phone }}
											</div>
											{% endif %}
											
											{% if data.contact_info.location %}
											<div class="contact-item">
												<i class="fas fa-map-marker-alt"></i> {{ data.contact_info.location }}
											</div>
											{% endif %}
											
											{% if data.contact_info.linkedin %}
											<div class="contact-item">
												<i class="fab fa-linkedin"></i> {{ data.contact_info.linkedin }}
											</div>
											{% endif %}
											
											{% if data.contact_info.github %}
											<div class="contact-item">
												<i class="fab fa-github"></i> {{ data.contact_info.github }}
											</div>
											{% endif %}
											
											{% if data.contact_info.website %}
											<div class="contact-item">
												<i class="fas fa-globe"></i> {{ data.contact_info.website }}
											</div>
											{% endif %}
										</div>
										{% endif %}
									</div>
									{% endif %}
									
									{% if data.summary %}
									<div class="resume-content-section">
										<h4 class="resume-section-title">Professional Summary</h4>
										{% if resume.processed_resume and resume.processed_resume.feedback %}
											{% if resume.processed_resume.feedback.error %}
												<div class="alert alert-danger">
													<strong>Error:</strong> {{ resume.processed_resume.feedback.error }}
													<p>Please try reprocessing this resume or check the system logs for more details.</p>
												</div>
											{% elif resume.processed_resume.feedback.summary %}
												<p>{{ resume.processed_resume.feedback.summary }}</p>
											{% else %}
												<p>No summary available.</p>
											{% endif %}
										{% else %}
											<p>No professional summary available.</p>
										{% endif %}
									</div>
									{% endif %}
									
									{% if data.skills %}
									<div class="resume-content-section">
										<h4 class="resume-section-title">Skills</h4>
										<div class="skills-grid">
											{% for skill in data.skills %}
												{% if skill is mapping and skill.name %}
													<div class="skill-tag">
														{{ skill.name }}
														{% if skill.level %}
															<span class="skill-level">{{ skill.level }}</span>
														{% endif %}
													</div>
												{% else %}
													<div class="skill-tag">{{ skill }}</div>
												{% endif %}
											{% endfor %}
										</div>
									</div>
									{% endif %}
									
									{% if data.experience %}
									<div class="resume-content-section">
										<h4 class="resume-section-title">Work Experience</h4>
										{% for exp in data.experience %}
										<div class="experience-item">
											<div class="item-header">
												<div class="item-title">{{ exp.title }}</div>
												<div class="item-date">{{ exp.date_range }}</div>
											</div>
											<div class="item-subtitle">{{ exp.company }}{% if exp.location %} - {{ exp.location }}{% endif %}</div>
											{% if exp.description %}
											<div class="item-description">
												{% if exp.description is string %}
													{{ exp.description }}
												{% elif exp.description is iterable %}
													<ul>
														{% for item in exp.description %}
														<li>{{ item }}</li>
														{% endfor %}
													</ul>
												{% endif %}
											</div>
											{% endif %}
										</div>
										{% endfor %}
									</div>
									{% endif %}
									
									{% if data.education %}
									<div class="resume-content-section">
										<h4 class="resume-section-title">Education</h4>
										{% for edu in data.education %}
										<div class="education-item">
											<div class="item-header">
												<div class="item-title">{{ edu.degree }}</div>
												<div class="item-date">{{ edu.year }}</div>
											</div>
											<div class="item-subtitle">{{ edu.institution }}{% if edu.location %} - {{ edu.location }}{% endif %}</div>
											{% if edu.field %}
											<div>Field: {{ edu.field }}</div>
											{% endif %}
											{% if edu.gpa %}
											<div>GPA: {{ edu.gpa }}</div>
											{% endif %}
										</div>
										{% endfor %}
									</div>
									{% endif %}
									
									{% if data.projects %}
									<div class="resume-content-section">
										<h4 class="resume-section-title">Projects</h4>
										{% for project in data.projects %}
										<div class="project-item">
											<div class="item-header">
												<div class="item-title">{{ project.name }}</div>
												{% if project.date %}
												<div class="item-date">{{ project.date }}</div>
												{% endif %}
											</div>
											{% if project.description %}
											<div class="item-description">
												{% if project.description is string %}
													{{ project.description }}
												{% elif project.description is iterable %}
													<ul>
														{% for item in project.description %}
														<li>{{ item }}</li>
														{% endfor %}
													</ul>
												{% endif %}
											</div>
											{% endif %}
											{% if project.technologies %}
											<div class="skills-grid" style="margin-top: 10px;">
												{% for tech in project.technologies %}
												<div class="skill-tag">{{ tech }}</div>
												{% endfor %}
											</div>
											{% endif %}
										</div>
										{% endfor %}
									</div>
									{% endif %}
									
									{% if data.certifications %}
									<div class="resume-content-section">
										<h4 class="resume-section-title">Certifications</h4>
										<ul>
											{% for cert in data.certifications %}
											<li>
												<strong>{{ cert.name }}</strong>
												{% if cert.issuer %} - {{ cert.issuer }}{% endif %}
												{% if cert.date %} ({{ cert.date }}){% endif %}
											</li>
											{% endfor %}
										</ul>
									</div>
									{% endif %}
									
									{% if data.languages %}
									<div class="resume-content-section">
										<h4 class="resume-section-title">Languages</h4>
										<ul>
											{% for lang in data.languages %}
											<li>
												<strong>{{ lang.language }}</strong>
												{% if lang.proficiency %} - {{ lang.proficiency }}{% endif %}
											</li>
											{% endfor %}
										</ul>
									</div>
									{% endif %}
									
								{% else %}
								<p>No processed content available.</p>
								{% endif %}
							</div>
						</div>
					</div>
				</div>
			</main>
		</div>

		<footer class="main-footer">
			<div class="container">
				<p>&copy; 2024 Resume AI. All rights reserved.</p>
			</div>
		</footer>

		<!-- JavaScript -->
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
		<script src="{{ url_for('static', filename='js/admin.js') }}"></script>
		<script>
			document.addEventListener('DOMContentLoaded', function () {
				// Add logout functionality to the header link
				document
					.getElementById("logout-link")
					.addEventListener("click", function (e) {
						e.preventDefault();
						// Clear cookies and localStorage
						document.cookie =
							"access_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
						document.cookie =
							"refresh_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
						localStorage.removeItem("access_token");
						localStorage.removeItem("refresh_token");

						// Redirect to login page
						window.location.href = "/admin/login";
					});

				// Handle save feedback button
				document.getElementById('save-feedback-btn').addEventListener('click', function () {
					const resumeId = this.dataset.id;
					const feedback = document.getElementById('admin-feedback').value;
					
					saveFeedback(resumeId, feedback);
				});
				
				// Handle approve button
				document.querySelector('.approve-cv').addEventListener('click', function () {
					const resumeId = this.dataset.id;
					updateCVStatus(resumeId, 'approved');
				});
				
				// Handle reject button
				document.querySelector('.reject-cv').addEventListener('click', function () {
					const resumeId = this.dataset.id;
					updateCVStatus(resumeId, 'rejected');
				});

				// Add event listener for reprocess button
				const reprocessButtons = document.querySelectorAll('.reprocess-btn');
				
				reprocessButtons.forEach(button => {
					button.addEventListener('click', function() {
						const resumeId = this.getAttribute('data-resume-id');
						this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
						this.disabled = true;
						
						// Send request to reprocess the resume
						fetch(`/admin/resumes/${resumeId}/reprocess`, {
							method: 'POST',
							headers: {
								'Content-Type': 'application/json',
								'X-CSRFToken': '{{ csrf_token() }}'
							}
						})
						.then(response => response.json())
						.then(data => {
							if (data.success) {
								// Reload the page to show updated results
								window.location.reload();
							} else {
								alert('Error: ' + data.error);
								this.innerHTML = '<i class="fas fa-sync-alt"></i> Reprocess Resume';
								this.disabled = false;
							}
						})
						.catch(error => {
							console.error('Error:', error);
							alert('An error occurred while reprocessing the resume.');
							this.innerHTML = '<i class="fas fa-sync-alt"></i> Reprocess Resume';
							this.disabled = false;
						});
					});
				});
			});
			
			// Save feedback function
			function saveFeedback(resumeId, feedback) {
				fetch(`/admin/api/resumes/${resumeId}/feedback`, {
					method: 'PUT',
					headers: {
						'Content-Type': 'application/json',
					},
					body: JSON.stringify({ feedback })
				})
				.then(response => response.json())
				.then(data => {
					if (data.error) {
						showNotification(data.error, 'error');
					} else {
						showNotification('Feedback saved successfully', 'success');
					}
				})
				.catch(error => {
					console.error('Error saving feedback:', error);
					showNotification('Error saving feedback', 'error');
				});
			}
			
			// Update CV status function
			function updateCVStatus(resumeId, status) {
				fetch(`/admin/api/resumes/${resumeId}/status`, {
					method: 'PUT',
					headers: {
						'Content-Type': 'application/json',
					},
					body: JSON.stringify({ status })
				})
				.then(response => response.json())
				.then(data => {
					if (data.error) {
						showNotification(data.error, 'error');
					} else {
						showNotification(`Resume ${status} successfully`, 'success');
						// Reload page to reflect changes
						setTimeout(() => {
							window.location.reload();
						}, 1000);
					}
				})
				.catch(error => {
					console.error('Error updating status:', error);
					showNotification('Error updating status', 'error');
				});
			}
			
			// Show notification function
			function showNotification(message, type) {
				if (typeof toastr !== 'undefined') {
					toastr[type](message);
				} else {
					alert(message);
				}
			}
		</script>
	</body>
</html> 